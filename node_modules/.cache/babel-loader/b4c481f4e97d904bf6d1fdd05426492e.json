{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar react_1 = require(\"react\");\n\nvar common_1 = require(\"./common\");\n\nvar FORCE_STATE_ACTION = '__FORCE_STATE_INTERNAL_API__';\n\nfunction isForceStateAction(action) {\n  return typeof action === 'object' && action !== null && 'type' in action && action.type === FORCE_STATE_ACTION;\n}\n\nfunction addForceStateActionToReducer(reducer) {\n  return function (state, action) {\n    if (isForceStateAction(action)) return action.payload;\n    return reducer(state, action);\n  };\n}\n\nfunction useStorageReducer(storage, key, reducer, defaultInitialArg, defaultInit) {\n  if (defaultInit === void 0) {\n    defaultInit = function (x) {\n      return x;\n    };\n  }\n\n  var defaultState = defaultInit(defaultInitialArg);\n\n  var _a = react_1.useReducer(addForceStateActionToReducer(reducer), common_1.useInitialState(storage, key, defaultState)),\n      state = _a[0],\n      dispatch = _a[1];\n\n  common_1.useStorageListener(storage, key, defaultState, function (newValue) {\n    dispatch({\n      type: FORCE_STATE_ACTION,\n      payload: newValue\n    });\n  });\n  var writeError = common_1.useStorageWriter(storage, key, state);\n  return [state, dispatch, writeError];\n}\n\nexports.default = useStorageReducer;","map":{"version":3,"mappings":";;;;;;AAAA;;AAEA;;AAOA,IAAMA,kBAAkB,GAAG,8BAA3B;;AAGA,SAASC,kBAAT,CACEC,MADF,EACiC;AAE/B,SACE,OAAOA,MAAP,KAAkB,QAAlB,IACAA,MAAM,KAAK,IADX,IAEA,UAAUA,MAFV,IAGAA,MAAM,CAACC,IAAP,KAAgBH,kBAJlB;AAMD;;AAED,SAASI,4BAAT,CAA4CC,OAA5C,EAAkE;AAChE,SAAO,UAACC,KAAD,EAAWJ,MAAX,EAA0C;AAC/C,QAAID,kBAAkB,CAACC,MAAD,CAAtB,EAAgC,OAAOA,MAAM,CAACK,OAAd;AAChC,WAAOF,OAAO,CAACC,KAAD,EAAQJ,MAAR,CAAd;AACD,GAHD;AAID;;AAiBD,SAASM,iBAAT,CACEC,OADF,EAEEC,GAFF,EAGEL,OAHF,EAIEM,iBAJF,EAKEC,WALF,EAK8D;AAA5D;AAAAA,4BAAgDC,CAAhD,EAAiD;AAAK;AAAM,KAA5D;AAA4D;;AAE5D,MAAMC,YAAY,GAAGF,WAAW,CAACD,iBAAD,CAAhC;;AAEM;AAAA,MAACL,aAAD;AAAA,MAAQS,gBAAR;;AAKNC,8BAAmBP,OAAnB,EAA4BC,GAA5B,EAAiCI,YAAjC,EAA+C,UAACG,QAAD,EAAY;AACzDF,YAAQ,CAAC;AAAEZ,UAAI,EAAEH,kBAAR;AAA4BO,aAAO,EAAEU;AAArC,KAAD,CAAR;AACD,GAFD;AAGA,MAAMC,UAAU,GAAGF,0BAAiBP,OAAjB,EAA0BC,GAA1B,EAA+BJ,KAA/B,CAAnB;AAEA,SAAO,CAACA,KAAD,EAAQS,QAAR,EAAkBG,UAAlB,CAAP;AACD;;AAEDC,kBAAeX,iBAAf","names":["FORCE_STATE_ACTION","isForceStateAction","action","type","addForceStateActionToReducer","reducer","state","payload","useStorageReducer","storage","key","defaultInitialArg","defaultInit","x","defaultState","dispatch","common_1","newValue","writeError","exports"],"sourceRoot":"","sources":["../src/reducer.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}