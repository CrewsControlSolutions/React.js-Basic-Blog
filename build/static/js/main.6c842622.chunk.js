(this["webpackJsonpproject-05"]=this["webpackJsonpproject-05"]||[]).push([[0],{213:function(e,t,n){},214:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(47),c=n.n(r),o=(n(85),n(8)),u=n(7),s=n(2),i=n(48),m=Object(a.createContext)({email:"",isAuthenticated:!1}),p=function(e){var t=Object(a.useContext)(m),n=t.user,r=t.onLogout;return l.a.createElement("header",{className:"App-header"},l.a.createElement("ul",{className:"container"},l.a.createElement("li",null,l.a.createElement(u.b,{to:"/"},"My Site")),n.isAuthenticated?l.a.createElement(l.a.Fragment,null,l.a.createElement("li",null,l.a.createElement(u.b,{to:"/new"},"New Post")),l.a.createElement("li",null,l.a.createElement("button",{className:"linkLike",onClick:function(e){e.preventDefault(),r()}},"Logout"))):l.a.createElement("li",null,l.a.createElement(u.b,{to:"/login"},"Login"))))},d=function(e){var t=e.type;return l.a.createElement("div",{className:"App-message ".concat(t)},l.a.createElement("p",{className:"container"},l.a.createElement("strong",null,{saved:"Post has been saved!",updated:"Post has been updated!",deleted:"Post has been deleted."}[t])))},E=function(e){var t=e.posts,n=e.deletePost,r=Object(a.useContext)(m).user;return l.a.createElement("article",{className:"posts container"},l.a.createElement("h1",null,"Posts"),l.a.createElement("ul",null,t.length<1&&l.a.createElement("li",{key:"empty"},"No posts yet!"),t.map((function(e){return l.a.createElement("li",{key:e.key},l.a.createElement("h2",null,l.a.createElement(u.b,{to:"/post/".concat(e.slug)},e.title)),r.isAuthenticated&&l.a.createElement("p",null,l.a.createElement(u.b,{to:"/edit/".concat(e.slug)},"Edit")," | ",l.a.createElement("button",{className:"linkLike",onClick:function(){return n(e)}},"Delete")))}))))},f=n(78),b=function(e){var t=e.post,n=new f.QuillDeltaToHtmlConverter(t.content.ops,{}).convert();return l.a.createElement("article",{className:"post container"},l.a.createElement("h1",null,t.title),l.a.createElement("div",{className:"content",dangerouslySetInnerHTML:{__html:n}}))},g=n(14),h=n(79),v=n.n(h),j=function(e){var t=e.post,n=e.addNewPost,r=e.updatePost,c=Object(a.useState)(Object(g.a)({},t)),u=Object(o.a)(c,2),i=u[0],m=u[1],p=Object(a.useState)(!1),d=Object(o.a)(p,2),E=d[0],f=d[1],b=Object(a.useRef)();Object(a.useEffect)((function(){b.current=i}),[i]);var h=b.current,j=l.a.useRef();Object(a.useEffect)((function(){h&&j.current&&t.key!==h.key&&(m(Object(g.a)({},t)),j.current.getEditor().setContents(""))}),[h,t]);return!0===E?l.a.createElement(s.a,{to:"/"}):l.a.createElement("form",{className:"container",onSubmit:function(e){e.preventDefault(),i.title?(r?r(i):n(i),f(!0)):alert("Title required")}},l.a.createElement("h1",null,"Add a New Post"),l.a.createElement("p",null,l.a.createElement("label",{htmlFor:"form-title"},"Title:"),l.a.createElement("br",null),l.a.createElement("input",{defaultValue:i.title,key:"form-title",value:i.title,onChange:function(e){return m(Object(g.a)(Object(g.a)({},i),{},{title:e.target.value}))}})),l.a.createElement("p",null,l.a.createElement("label",{htmlFor:"form-content"},"Content:")),l.a.createElement(v.a,{ref:j,defaultValue:i.content,onChange:function(e,t,n,a){m(Object(g.a)(Object(g.a)({},i),{},{content:a.getContents()}))}}),l.a.createElement("p",null,l.a.createElement("button",{type:"submit"},"Save")))},O=function(){return l.a.createElement("article",{className:"not-found container"},l.a.createElement("h1",null,"404!"),l.a.createElement("p",null,"Content not found. ",l.a.createElement(u.b,{to:"/"},"Return to posts")))},y=function(e){var t=Object(a.useContext)(m).onLogin,n=Object(a.useState)(""),r=Object(o.a)(n,2),c=r[0],u=r[1],s=Object(a.useState)(""),i=Object(o.a)(s,2),p=i[0],d=i[1];return l.a.createElement("form",{className:"container",name:"login",onSubmit:function(e){e.preventDefault(),t(c,p)}},l.a.createElement("p",null,l.a.createElement("label",{htmlFor:"email"},"Email:"),l.a.createElement("input",{type:"email",onChange:function(e){return u(e.target.value)}})),l.a.createElement("p",null,l.a.createElement("label",{htmlFor:"password"},"Password:"),l.a.createElement("input",{type:"password",onChange:function(e){return d(e.target.value)}})),l.a.createElement("p",null,l.a.createElement("button",{type:"submit",disabled:!c&&!p},"Login")))},w=n(50);n(207),n(209);w.initializeApp({apiKey:"AIzaSyDG9UAcd8r6MrgejzWqDF4cTeVXJ_xWljE",authDomain:"react-blog-demo-1.firebaseapp.com",databaseURL:"https://react-blog-demo-1-default-rtdb.firebaseio.com",projectId:"react-blog-demo-1",storageBucket:"react-blog-demo-1.appspot.com",messagingSenderId:"702257424356",appId:"1:702257424356:web:0e3d95f0654cace51089f1"});var k=w,S=(n(213),function(e){var t=Object(i.useStorageState)(localStorage,"state-posts",[]),n=Object(o.a)(t,2),r=n[0],c=n[1],f=Object(a.useState)(null),g=Object(o.a)(f,2),h=g[0],v=g[1],w=Object(i.useStorageState)(localStorage,"state-user",{}),S=Object(o.a)(w,2),N=S[0],C=S[1];Object(a.useEffect)((function(){k.database().ref("posts").on("value",(function(e){var t=e.val(),n=[];for(var a in t)n.push({key:a,slug:t[a].slug,title:t[a].title,content:t[a].content});c(n)}))}),[c]);var A=function(e){v(e),setTimeout((function(){v(null)}),1600)},P=function(e){return encodeURIComponent(e.toLowerCase().split(" ").join("-"))},L=function(e){var t=k.database().ref("posts");e.slug=P(e.title),delete e.key,t.push(e),A("saved")},x=function(e){k.database().ref("posts/"+e.key).update({slug:P(e.title),title:e.title,content:e.content}),A("updated")},D=function(e){window.confirm("Delete this post?")&&(k.database().ref("posts/"+e.key).remove(),A("deleted"))};return l.a.createElement(u.a,null,l.a.createElement(m.Provider,{value:{user:N,onLogin:function(e,t){k.auth().signInWithEmailAndPassword(e,t).then((function(e){C({email:e.user.email,isAuthenticated:!0})})).catch((function(e){return console.error(e)}))},onLogout:function(){k.auth().signOut().then((function(){C({isAuthenticated:!1})})).catch((function(e){return console.error(e)}))}}},l.a.createElement("div",{className:"App"},l.a.createElement(p,null),h&&l.a.createElement(d,{type:h}),l.a.createElement(s.d,null,l.a.createElement(s.b,{exact:!0,path:"/",render:function(){return l.a.createElement(E,{posts:r,deletePost:D})}}),l.a.createElement(s.b,{path:"/post/:postSlug",render:function(e){var t=r.find((function(t){return t.slug===e.match.params.postSlug}));return t?l.a.createElement(b,{post:t}):l.a.createElement(s.a,{to:"/"})}}),l.a.createElement(s.b,{exact:!0,path:"/login",render:function(){return N.isAuthenticated?l.a.createElement(s.a,{to:"/"}):l.a.createElement(y,null)}}),l.a.createElement(s.b,{exact:!0,path:"/new",render:function(){return N.isAuthenticated?l.a.createElement(j,{addNewPost:L,post:{key:null,slug:"",title:"",content:""}}):l.a.createElement(s.a,{to:"/login"})}}),l.a.createElement(s.b,{path:"/edit/:postSlug",render:function(e){var t=r.find((function(t){return t.slug===e.match.params.postSlug}));return t?N.isAuthenticated?l.a.createElement(j,{updatePost:x,post:t}):l.a.createElement(s.a,{to:"/login"}):l.a.createElement(s.a,{to:"/"})}}),l.a.createElement(s.b,{component:O})))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},80:function(e,t,n){e.exports=n(214)},85:function(e,t,n){}},[[80,1,2]]]);
//# sourceMappingURL=main.6c842622.chunk.js.map